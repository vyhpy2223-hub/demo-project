<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mentor Dashboard - AI English Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        /* ========================================
        RESET & GLOBAL
        ======================================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background: #f0f7ff;
            color: #333;
        }
        /* ========================================
        LAYOUT
        ======================================== */
        .layout {
            display: flex;
            min-height: 100vh;
        }
        /* ========================================
        SIDEBAR
        ======================================== */
        .sidebar {
            width: 240px;
            background: #eef5ff;
            padding: 20px;
            border-right: 1px solid #d6e4ff;
            height: 100vh;
            overflow-y: auto;
        }
        .sidebar h3 {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 30px;
            color: #4361ee;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .sidebar ul {
            list-style: none;
        }
        .sidebar li {
            padding: 12px 16px;
            margin-bottom: 8px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 500;
            color: #4a5568;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .sidebar li i {
            width: 20px;
            text-align: center;
            font-size: 16px;
            color: #64748b;
        }
        .sidebar li:hover {
            background: #dde6ff;
            color: #4361ee;
        }
        .sidebar li.active {
            background: #d6e4ff;
            color: #4361ee;
            font-weight: 600;
        }
        .sidebar li.active i {
            color: #4361ee;
        }
        /* ========================================
        MAIN CONTENT
        ======================================== */
        .main {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            background: #f0f7ff;
        }
        /* HEADER */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        .header h2 {
            font-size: 28px;
            font-weight: 600;
            color: #1a202c;
        }
        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        .search-container {
            position: relative;
        }
        .search {
            padding: 10px 16px;
            border-radius: 10px;
            border: 1px solid #d6e4ff;
            background: white;
            width: 240px;
            font-size: 14px;
            transition: border 0.3s;
        }
        .search:focus {
            outline: none;
            border-color: #4361ee;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.15);
        }
        /* SEARCH SUGGESTIONS */
        .suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #d6e4ff;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.12);
            z-index: 1000;
            display: none;
            max-height: 300px;
            overflow-y: auto;
        }
        .suggestions.show {
            display: block;
        }
        .suggestion-item {
            padding: 12px 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid #edf2f7;
            transition: all 0.2s;
        }
        .suggestion-item:last-child {
            border-bottom: none;
        }
        .suggestion-item:hover {
            background: #f0f4ff;
            color: #4361ee;
        }
        .suggestion-item i {
            color: #4361ee;
            font-size: 16px;
        }
        /* AVATAR */
        .avatar-box {
            position: relative;
            cursor: pointer;
        }
        .avatar-box img {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #d6e4ff;
            transition: all 0.3s;
        }
        .avatar-box img:hover {
            border-color: #4361ee;
            transform: scale(1.1);
        }
        .avatar-menu {
            display: none;
            position: absolute;
            right: 0;
            top: 60px;
            background: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.12);
            width: 320px;
            z-index: 1000;
            animation: fadeIn 0.2s;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .avatar-menu.show {
            display: block;
        }
        .avatar-title {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 15px;
        }
        .avatar-list {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        .avatar-list img {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            cursor: pointer;
            object-fit: cover;
            border: 2px solid transparent;
            transition: all 0.2s;
        }
        .avatar-list img:hover,
        .avatar-list img.selected {
            transform: scale(1.1);
            border-color: #4361ee;
            box-shadow: 0 0 0 2px #c7d2fe;
        }
        .upload-section {
            background: #f8fafc;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 1px dashed #cbd5e1;
        }
        .upload-btn {
            background: #4361ee;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            width: 100%;
            margin-top: 10px;
            transition: all 0.2s;
        }
        .upload-btn:hover {
            background: #3a56d4;
            transform: translateY(-1px);
        }
        /* USER PANEL */
        .user-panel {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03);
        }
        .user-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .user-header h3 {
            font-size: 22px;
            font-weight: 600;
            color: #1a202c;
        }
        .add-btn {
            background: #4361ee;
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        .add-btn:hover {
            background: #3a56d4;
            transform: translateY(-1px);
        }
        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        .filters input,
        .filters select {
            padding: 10px 15px;
            border-radius: 10px;
            border: 1px solid #d6e4ff;
            background: white;
            font-size: 14px;
            min-width: 180px;
        }
        .filters input:focus,
        .filters select:focus {
            outline: none;
            border-color: #4361ee;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th {
            padding: 14px 12px;
            text-align: left;
            font-weight: 600;
            color: #4a5568;
            font-size: 14px;
            border-bottom: 2px solid #edf2f7;
        }
        td {
            padding: 16px 12px;
            text-align: left;
            border-bottom: 1px solid #edf2f7;
            color: #2d3748;
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 14px;
        }
        .user-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }
        .status {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
        }
        .active {
            background: #ecfdf5;
            color: #047857;
        }
        .pending {
            background: #fffbeb;
            color: #b45309;
        }
        .blocked {
            background: #fee2e2;
            color: #dc2626;
        }
        .manage {
            background: #4361ee;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }
        .manage:hover {
            background: #3a56d4;
            transform: translateY(-1px);
        }
        /* STAR RATING */
        .stars {
            display: flex;
            gap: 4px;
            margin: 10px 0;
        }
        .star {
            font-size: 24px;
            color: #e2e8f0;
            cursor: pointer;
            transition: all 0.2s;
        }
        .star.active,
        .star:hover {
            color: #f59e0b;
        }
        /* FEEDBACK CARD */
        .feedback-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03);
            border: 1px solid #edf2f7;
        }
        .feedback-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .feedback-author {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .feedback-author img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }
        .feedback-actions {
            display: flex;
            gap: 8px;
        }
        .feedback-btn {
            padding: 8px 12px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        .edit-btn {
            background: #e0e7ff;
            color: #4361ee;
        }
        .edit-btn:hover {
            background: #d6e4ff;
        }
        .delete-btn {
            background: #fee2e2;
            color: #dc2626;
        }
        .delete-btn:hover {
            background: #fecaca;
        }
        .feedback-content {
            margin-bottom: 15px;
        }
        .feedback-rating {
            margin: 15px 0;
        }
        .feedback-meta {
            display: flex;
            justify-content: space-between;
            color: #718096;
            font-size: 14px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #edf2f7;
        }
        /* MATERIALS GRID */
        .materials-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }
        .material-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03);
            border: 1px solid #edf2f7;
            transition: all 0.3s ease;
        }
        .material-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .material-img {
            height: 160px;
            background: linear-gradient(135deg, #4361ee, #5b7bff);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 48px;
        }
        .material-content {
            padding: 24px;
        }
        .material-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 12px;
            color: #1a202c;
        }
        .material-desc {
            color: #4a5568;
            line-height: 1.6;
            margin-bottom: 20px;
            font-size: 15px;
        }
        .material-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 16px;
            border-top: 1px solid #edf2f7;
            font-size: 15px;
            color: #718096;
        }
        .material-type {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
        }
        .type-pdf {
            background: #fef3c7;
            color: #92400e;
        }
        .type-video {
            background: #dbeafe;
            color: #1e40af;
        }
        .type-doc {
            background: #dcfce7;
            color: #166534;
        }
        /* TOPIC CARDS */
        .topic-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }
        .topic-card {
            background: white;
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03);
            border: 1px solid #edf2f7;
            transition: all 0.3s ease;
        }
        .topic-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
        .topic-card h4 {
            color: #4361ee;
            margin-bottom: 12px;
            font-size: 20px;
        }
        .topic-card p {
            color: #4a5568;
            margin-bottom: 16px;
            line-height: 1.6;
        }
        .topic-meta {
            display: flex;
            justify-content: space-between;
            color: #718096;
            font-size: 14px;
            margin-bottom: 16px;
        }
        .topic-actions {
            display: flex;
            gap: 10px;
        }
        .topic-btn {
            padding: 8px 12px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }
        .topic-btn.edit {
            background: #e0e7ff;
            color: #4361ee;
        }
        .topic-btn.edit:hover {
            background: #d6e4ff;
        }
        .topic-btn.delete {
            background: #fee2e2;
            color: #dc2626;
        }
        .topic-btn.delete:hover {
            background: #fecaca;
        }
        /* SESSION FEEDBACK */
        .session-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03);
            border: 1px solid #edf2f7;
        }
        .session-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #edf2f7;
        }
        .session-date {
            font-size: 18px;
            font-weight: 600;
            color: #1a202c;
        }
        .session-student {
            font-size: 16px;
            color: #4a5568;
        }
        .session-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .session-section {
            background: #f8fafc;
            padding: 20px;
            border-radius: 16px;
        }
        .session-section h5 {
            color: #4361ee;
            margin-bottom: 12px;
            font-size: 18px;
        }
        .session-feedback {
            margin-bottom: 15px;
            padding: 12px;
            background: white;
            border-radius: 12px;
            border-left: 4px solid #4361ee;
        }
        .session-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #d6e4ff;
            border-radius:8px;
            background: white;
            font-size: 15px;
            margin-top: 8px;
            display: none;
        }
        .session-input.show {
            display: block;
        }
        .session-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .session-action-btn {
            padding: 8px 16px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }
        .session-action-btn.save {
            background: #4361ee;
            color: white;
        }
        .session-action-btn.save:hover {
            background: #3a56d4;
        }
        .session-action-btn.cancel {
            background: #f1f5ff;
            color: #4361ee;
        }
        .session-action-btn.cancel:hover {
            background: #e0e7ff;
        }
        /* PAGE CONTENTS */
        .page-content {
            display: none;
        }
        .page-content.active {
            display: block;
            animation: slideIn 0.3s;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        /* TOAST */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #1a202c;
            color: white;
            padding: 14px 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 2000;
            transform: translateX(400px);
            opacity: 0;
            transition: all 0.3s;
        }
        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }
        /* RESPONSIVE */
        @media (max-width: 768px) {
            .layout {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
                height: auto;
                padding: 16px;
            }
            .main {
                padding: 20px;
            }
            .header {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }
            .header-right {
                width: 100%;
                justify-content: space-between;
            }
            .search {
                width: 100%;
            }
            .materials-grid,
            .topic-grid {
                grid-template-columns: 1fr;
            }
            .session-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="layout">
        <!-- SIDEBAR -->
        <div class="sidebar">
            <h3><i class="fas fa-robot"></i> Mentor Dashboard</h3>
            <ul>
                <li class="active" data-page="dashboard">
                    <i class="fas fa-home"></i> Dashboard Overview
                </li>
                <li data-page="evaluations">
                    <i class="fas fa-star"></i> Evaluate & Assess Students
                </li>
                <li data-page="materials">
                    <i class="fas fa-book-open"></i> Provide Study Materials
                </li>
                <li data-page="feedback">
                    <i class="fas fa-comments"></i> Give Feedback & Suggestions
                </li>
                <li data-page="topics">
                    <i class="fas fa-lightbulb"></i> Propose Topics & Situations
                </li>
                <li data-page="sessions">
                    <i class="fas fa-calendar-check"></i> Post-Session Feedback
                </li>
            </ul>
        </div>
        <!-- MAIN CONTENT -->
        <div class="main">
            <!-- HEADER -->
            <div class="header">
                <h2 id="pageTitle">Dashboard Overview</h2>
                <div class="header-right">
                    <div class="search-container">
                        <input class="search" id="globalSearch" placeholder="Search..." autocomplete="off">
                        <div class="suggestions" id="searchSuggestions"></div>
                    </div>
                    <i class="fas fa-bell" style="font-size: 22px; color: #4a5568; cursor: pointer;"></i>
                    <div class="avatar-box">
                        <img id="mainAvatar" src="https://i.pravatar.cc/40?img=12" alt="User Avatar">
                        <div id="avatarMenu" class="avatar-menu">
                            <div class="avatar-title">Select Profile Picture</div>
                            <div class="avatar-list">
                                <img src="https://i.pravatar.cc/40?img=1" data-img-num="1" alt="Avatar 1">
                                <img src="https://i.pravatar.cc/40?img=5" data-img-num="5" alt="Avatar 5">
                                <img src="https://i.pravatar.cc/40?img=8" data-img-num="8" alt="Avatar 8">
                                <img src="https://i.pravatar.cc/40?img=15" data-img-num="15" alt="Avatar 15">
                                <img src="https://i.pravatar.cc/40?img=22" data-img-num="22" alt="Avatar 22">
                            </div>
                            <div class="upload-section">
                                <p style="color: #4a5568; margin-bottom: 8px; font-size: 14px;">Upload from your device</p>
                                <input type="file" id="imageUpload" accept="image/*" hidden>
                                <button class="upload-btn" onclick="document.getElementById('imageUpload').click()">
                                    <i class="fas fa-upload"></i> Choose Image
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- DASHBOARD -->
            <div id="dashboard" class="page-content active">
                <div class="user-panel">
                    <div class="user-header">
                        <h3>Learning Platform Overview</h3>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 25px; margin-bottom: 30px;">
                        <div style="background: white; padding: 25px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.03); text-align: center;">
                            <i class="fas fa-users" style="font-size: 32px; color: #4361ee; margin-bottom: 15px;"></i>
                            <h4 style="color: #718096; margin-bottom: 10px;">Total Students</h4>
                            <div style="font-size: 32px; font-weight: 700; color: #1a202c;">2,846</div>
                        </div>
                        <div style="background: white; padding: 25px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.03); text-align: center;">
                            <i class="fas fa-comments" style="font-size: 32px; color: #4361ee; margin-bottom: 15px;"></i>
                            <h4 style="color: #718096; margin-bottom: 10px;">Feedback Given</h4>
                            <div style="font-size: 32px; font-weight: 700; color: #1a202c;">156</div>
                        </div>
                        <div style="background: white; padding: 25px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.03); text-align: center;">
                            <i class="fas fa-book" style="font-size: 32px; color: #4361ee; margin-bottom: 15px;"></i>
                            <h4 style="color: #718096; margin-bottom: 10px;">Materials Shared</h4>
                            <div style="font-size: 32px; font-weight: 700; color: #1a202c;">47</div>
                        </div>
                        <div style="background: white; padding: 25px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.03); text-align: center;">
                            <i class="fas fa-calendar-check" style="font-size: 32px; color: #4361ee; margin-bottom: 15px;"></i>
                            <h4 style="color: #718096; margin-bottom: 10px;">Lessons Completed</h4>
                            <div style="font-size: 32px; font-weight: 700; color: #1a202c;">128</div>
                        </div>
                    </div>
                    <div style="background: white; padding: 30px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.03);">
                        <h4 style="color: #4361ee; margin-bottom: 20px;">Student Growth Chart</h4>
                        <div style="height: 300px; background: #f8fafc; border-radius: 16px; display: flex; align-items: center; justify-content: center; color: #4a5568;">
                            <p>ðŸ“Š Chart visualization will appear here</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- EVALUATIONS -->
            <div id="evaluations" class="page-content">
                <div class="user-panel">
                    <div class="user-header">
                        <h3>Evaluate & Assess Students</h3>
                        <button class="add-btn" onclick="openAddEvaluation()">
                            <i class="fas fa-plus"></i> Add New Evaluation
                        </button>
                    </div>
                    <div class="filters">
                        <input placeholder="Search students..." oninput="filterEvaluations(this.value)">
                        <select onchange="filterByLevel(this.value)">
                            <option value="">All Levels</option>
                            <option value="Beginner">Beginner</option>
                            <option value="Intermediate">Intermediate</option>
                            <option value="Advanced">Advanced</option>
                        </select>
                    </div>
                    <div id="evaluationsList">
                        <!-- Evaluations will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- MATERIALS -->
            <div id="materials" class="page-content">
                <div class="user-panel">
                    <div class="user-header">
                        <h3>Provide Study Materials</h3>
                        <button class="add-btn" onclick="openAddMaterial()">
                            <i class="fas fa-plus"></i> Add New Material
                        </button>
                    </div>
                    <input class="search" placeholder="Search materials by topic..." oninput="searchMaterials(this.value)" style="margin-bottom: 25px;">
                    <div class="materials-grid">
                        <!-- Materials will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- SPECIFIC FEEDBACK -->
            <div id="feedback" class="page-content">
                <div class="user-panel">
                    <div class="user-header">
                        <h3>Give Feedback & Suggestions</h3>
                        <button class="add-btn" onclick="openAddSpecificFeedback()">
                            <i class="fas fa-plus"></i> Add New Feedback
                        </button>
                    </div>
                    <div class="filters">
                        <select onchange="filterFeedbackByType(this.value)">
                            <option value="">All Types</option>
                            <option value="pronunciation">Pronunciation</option>
                            <option value="grammar">Grammar</option>
                            <option value="vocabulary">Vocabulary</option>
                        </select>
                        <input placeholder="Search students..." oninput="filterFeedbackByStudent(this.value)">
                    </div>
                    <div id="specificFeedbackList">
                        <!-- Specific feedback will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- TOPICS -->
            <div id="topics" class="page-content">
                <div class="user-panel">
                    <div class="user-header">
                        <h3>Propose Topics & Situations</h3>
                        <button class="add-btn" onclick="openAddTopic()">
                            <i class="fas fa-plus"></i> Add New Topic
                        </button>
                    </div>
                    <input class="search" placeholder="Search topics..." oninput="searchTopics(this.value)" style="margin-bottom: 25px;">
                    <div class="topic-grid">
                        <!-- Topics will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- SESSION FEEDBACK -->
            <div id="sessions" class="page-content">
                <div class="user-panel">
                    <div class="user-header">
                        <h3>Post-Session Feedback</h3>
                        <button class="add-btn" onclick="openAddSessionFeedback()">
                            <i class="fas fa-plus"></i> Add New Session
                        </button>
                    </div>
                    <input class="search" placeholder="Search sessions..." oninput="filterSessions(this.value)" style="margin-bottom: 25px;">
                    <div id="sessionsList">
                        <!-- Sessions will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- TOAST -->
            <div id="toast" class="toast"></div>
        </div>
    </div>

    <script>
        // ===== STATE MANAGEMENT =====
        const appState = {
            evaluations: [],
            materials: [],
            specificFeedback: [],
            topics: [],
            sessionFeedback: [],
            init() {
                this.loadFromStorage();
                this.setupGlobalSearch();
                this.setupAvatarHandling();
                this.renderAllPages();
            },
            loadFromStorage() {
                this.evaluations = JSON.parse(localStorage.getItem('mentor_evaluations') || '[]');
                this.materials = JSON.parse(localStorage.getItem('mentor_materials') || '[]');
                this.specificFeedback = JSON.parse(localStorage.getItem('mentor_specific_feedback') || '[]');
                this.topics = JSON.parse(localStorage.getItem('mentor_topics') || '[]');
                this.sessionFeedback = JSON.parse(localStorage.getItem('mentor_session_feedback') || '[]');
            },
            saveToStorage() {
                localStorage.setItem('mentor_evaluations', JSON.stringify(this.evaluations));
                localStorage.setItem('mentor_materials', JSON.stringify(this.materials));
                localStorage.setItem('mentor_specific_feedback', JSON.stringify(this.specificFeedback));
                localStorage.setItem('mentor_topics', JSON.stringify(this.topics));
                localStorage.setItem('mentor_session_feedback', JSON.stringify(this.sessionFeedback));
            },
            addEvaluation(data) {
                const newEval = {
                    id: Date.now().toString(),
                    ...data,
                    date: new Date().toLocaleString('en-US'),
                    mentor: 'Current Mentor'
                };
                this.evaluations.unshift(newEval);
                this.saveToStorage();
                this.renderEvaluations();
                showToast('âœ… Added new evaluation!', 'success');
            },
            updateEvaluation(id, data) {
                const index = this.evaluations.findIndex(e => e.id === id);
                if (index !== -1) {
                    this.evaluations[index] = { ...this.evaluations[index], ...data };
                    this.saveToStorage();
                    this.renderEvaluations();
                    showToast('âœ… Updated evaluation!', 'success');
                }
            },
            deleteEvaluation(id) {
                this.evaluations = this.evaluations.filter(e => e.id !== id);
                this.saveToStorage();
                this.renderEvaluations();
                showToast('ðŸ—‘ï¸ Evaluation deleted!', 'success');
            },
            addMaterial(data) {
                const newMat = {
                    id: Date.now().toString(),
                    ...data
                };
                this.materials.unshift(newMat);
                this.saveToStorage();
                this.renderMaterials();
                showToast('âœ… Added new material!', 'success');
            },
            addSpecificFeedback(data) {
                const newFeedback = {
                    id: Date.now().toString(),
                    ...data,
                    date: new Date().toLocaleDateString('en-US')
                };
                this.specificFeedback.unshift(newFeedback);
                this.saveToStorage();
                this.renderSpecificFeedback();
                showToast('âœ… Added new feedback!', 'success');
            },
            updateSpecificFeedback(id, data) {
                const index = this.specificFeedback.findIndex(f => f.id === id);
                if (index !== -1) {
                    this.specificFeedback[index] = { ...this.specificFeedback[index], ...data };
                    this.saveToStorage();
                    this.renderSpecificFeedback();
                    showToast('âœ… Updated feedback!', 'success');
                }
            },
            deleteSpecificFeedback(id) {
                this.specificFeedback = this.specificFeedback.filter(f => f.id !== id);
                this.saveToStorage();
                this.renderSpecificFeedback();
                showToast('ðŸ—‘ï¸ Feedback deleted!', 'success');
            },
            addTopic(data) {
                const newTopic = {
                    id: Date.now().toString(),
                    ...data
                };
                this.topics.unshift(newTopic);
                this.saveToStorage();
                this.renderTopics();
                showToast('âœ… Added new topic!', 'success');
            },
            updateTopic(id, data) {
                const index = this.topics.findIndex(t => t.id === id);
                if (index !== -1) {
                    this.topics[index] = { ...this.topics[index], ...data };
                    this.saveToStorage();
                    this.renderTopics();
                    showToast('âœ… Updated topic!', 'success');
                }
            },
            deleteTopic(id) {
                this.topics = this.topics.filter(t => t.id !== id);
                this.saveToStorage();
                this.renderTopics();
                showToast('ðŸ—‘ï¸ Topic deleted!', 'success');
            },
            addSessionFeedback(data) {
                const newSession = {
                    id: Date.now().toString(),
                    ...data,
                    date: new Date().toLocaleString('en-US')
                };
                this.sessionFeedback.unshift(newSession);
                this.saveToStorage();
                this.renderSessions();
                showToast('âœ… Added session feedback!', 'success');
            },
            updateSessionFeedback(id, field, value) {
                const session = this.sessionFeedback.find(s => s.id === id);
                if (session) {
                    session[field] = value;
                    this.saveToStorage();
                    this.renderSessions();
                    showToast('âœ… Updated session feedback!', 'success');
                }
            },
            renderAllPages() {
                this.renderEvaluations();
                this.renderMaterials();
                this.renderSpecificFeedback();
                this.renderTopics();
                this.renderSessions();
            }
        };

        // ===== PAGE NAVIGATION FUNCTION =====
        function switchPage(pageId) {
            // Hide all page content
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.remove('active');
            });
            // Remove active class from all sidebar items
            document.querySelectorAll('.sidebar li').forEach(item => {
                item.classList.remove('active');
            });
            // Show the selected page content
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            // Highlight the corresponding sidebar item
            const sidebarItem = document.querySelector(`[data-page="${pageId}"]`);
            if (sidebarItem) {
                sidebarItem.classList.add('active');
                // Update the header title based on the clicked sidebar item
                document.getElementById('pageTitle').textContent = sidebarItem.textContent.trim();
            }
        }

        // ===== RENDER FUNCTIONS =====
        function renderEvaluations() {
            const list = document.getElementById('evaluationsList');
            if (!list) return;
            list.innerHTML = appState.evaluations.map(eval => `
                <div class="feedback-card">
                    <div class="feedback-header">
                        <div class="feedback-author">
                            <img src="${eval.avatar || 'https://i.pravatar.cc/40?u=' + Math.random()}" alt="Student Avatar">
                            <div>
                                <strong>${eval.student}</strong>
                                <div>${eval.level}</div>
                            </div>
                        </div>
                        <div class="feedback-actions">
                            <button class="feedback-btn edit-btn" onclick="editFeedback('${eval.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="feedback-btn delete-btn" onclick="deleteFeedback('${eval.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                    <div class="feedback-content">
                        <p>${eval.content}</p>
                    </div>
                    <div class="feedback-rating">
                        <div class="stars" id="stars${eval.id}">
                            ${[1,2,3,4,5].map(i => `
                                <span class="star ${i <= eval.rating ? 'active' : ''}" onclick="rateFeedback('${eval.id}', ${i})">â˜…</span>
                            `).join('')}
                        </div>
                        <div>Rating: ${eval.rating} stars</div>
                    </div>
                    <div class="feedback-meta">
                        <span>Evaluated: ${eval.date}</span>
                        <span>Mentor: ${eval.mentor}</span>
                    </div>
                </div>
            `).join('');
        }

        function renderMaterials() {
            const grid = document.querySelector('.materials-grid');
            if (!grid) return;
            grid.innerHTML = appState.materials.map(mat => `
                <div class="material-card">
                    <div class="material-img">
                        <i class="fas ${mat.icon}"></i>
                    </div>
                    <div class="material-content">
                        <h4 class="material-title">${mat.title}</h4>
                        <p class="material-desc">${mat.description}</p>
                        <div class="material-meta">
                            <span class="material-type type-${mat.type.toLowerCase()}">${mat.type}</span>
                            <span>${mat.level}</span>
                        </div>
                        <a href="${mat.url}" class="material-link" target="_blank" style="display: block; margin-top: 15px; color: #4361ee; text-decoration: none; font-weight: 500;">
                            <i class="fas fa-external-link-alt"></i> ${mat.linkText || 'View Material'}
                        </a>
                    </div>
                </div>
            `).join('');
        }

        function renderSpecificFeedback() {
            const list = document.getElementById('specificFeedbackList');
            if (!list) return;
            list.innerHTML = appState.specificFeedback.map(feedback => `
                <div class="feedback-card">
                    <div class="feedback-header">
                        <div class="feedback-author">
                            <img src="${feedback.avatar || 'https://i.pravatar.cc/40?u=' + Math.random()}" alt="Student Avatar">
                            <div>
                                <strong>${feedback.student}</strong>
                                <div>${feedback.type} - ${feedback.level}</div>
                            </div>
                        </div>
                        <div class="feedback-actions">
                            <button class="feedback-btn edit-btn" onclick="editSpecificFeedback('${feedback.id}', '${feedback.type}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="feedback-btn delete-btn" onclick="deleteSpecificFeedback('${feedback.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                    <div class="feedback-content">
                        <p><strong>${feedback.type}:</strong> ${feedback.content}</p>
                    </div>
                    <div class="feedback-meta">
                        <span>Type: ${feedback.type}</span>
                        <span>Date: ${feedback.date}</span>
                    </div>
                </div>
            `).join('');
        }

        function renderTopics() {
            const grid = document.querySelector('.topic-grid');
            if (!grid) return;
            grid.innerHTML = appState.topics.map(topic => `
                <div class="topic-card">
                    <h4>${topic.title}</h4>
                    <p>${topic.description}</p>
                    <div class="topic-meta">
                        <span>Level: ${topic.level}</span>
                        <span>Proposed by: ${topic.author}</span>
                    </div>
                    <div class="topic-actions">
                        <button class="topic-btn edit" onclick="editTopic('${topic.id}')">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="topic-btn delete" onclick="deleteTopic('${topic.id}')">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function renderSessions() {
            const list = document.getElementById('sessionsList');
            if (!list) return;
            list.innerHTML = appState.sessionFeedback.map(session => `
                <div class="session-card">
                    <div class="session-header">
                        <div class="session-date">${session.date}</div>
                        <div class="session-student">${session.student} (${session.level})</div>
                    </div>
                    <div class="session-content">
                        <div class="session-section">
                            <h5>Pronunciation</h5>
                            <div class="session-feedback">
                                <strong>Strengths:</strong> ${session.pronunciationStrength || 'Good intonation and rhythm'}<br>
                                <strong>Areas for improvement:</strong> ${session.pronunciationWeakness || 'Final consonants need more practice'}
                            </div>
                            <textarea class="session-input" data-session="${session.id}" data-type="pronunciation">${session.pronunciationNotes || 'Emma pronounced most words clearly but needs to practice final consonants like \'d\', \'t\', and \'s\' endings.'}</textarea>
                            <div class="session-actions">
                                <button class="session-action-btn save" onclick="saveSessionFeedback('${session.id}', 'pronunciation')">Save</button>
                                <button class="session-action-btn cancel" onclick="cancelSessionEdit('${session.id}')">Cancel</button>
                            </div>
                        </div>
                        <div class="session-section">
                            <h5>Vocabulary</h5>
                            <div class="session-feedback">
                                <strong>Strengths:</strong> ${session.vocabularyStrength || 'Uses varied vocabulary'}<br>
                                <strong>Areas for improvement:</strong> ${session.vocabularyWeakness || 'Some context errors'}
                            </div>
                            <textarea class="session-input" data-session="${session.id}" data-type="vocabulary">${session.vocabularyNotes || 'Emma has good vocabulary range but occasionally uses words in incorrect contexts. Suggest more practice with collocations.'}</textarea>
                            <div class="session-actions">
                                <button class="session-action-btn save" onclick="saveSessionFeedback('${session.id}', 'vocabulary')">Save</button>
                                <button class="session-action-btn cancel" onclick="cancelSessionEdit('${session.id}')">Cancel</button>
                            </div>
                        </div>
                        <div class="session-section">
                            <h5>Grammar</h5>
                            <div class="session-feedback">
                                <strong>Strengths:</strong> ${session.grammarStrength || 'Uses basic structures correctly'}<br>
                                <strong>Areas for improvement:</strong> ${session.grammarWeakness || 'Tense consistency needs work'}
                            </div>
                            <textarea class="session-input" data-session="${session.id}" data-type="grammar">${session.grammarNotes || 'Adam needs more practice with past tense formation.'}</textarea>
                            <div class="session-actions">
                                <button class="session-action-btn save" onclick="saveSessionFeedback('${session.id}', 'grammar')">Save</button>
                                <button class="session-action-btn cancel" onclick="cancelSessionEdit('${session.id}')">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // ===== SEARCH FUNCTIONALITY =====
        function setupGlobalSearch() {
            const searchInput = document.getElementById('globalSearch');
            const suggestions = document.getElementById('searchSuggestions');

            searchInput.addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase();
                if (searchTerm.length < 2) {
                    suggestions.classList.remove('show');
                    return;
                }

                const results = [];

                // Search in sidebar items
                document.querySelectorAll('.sidebar li').forEach(item => {
                    const text = item.textContent.toLowerCase();
                    const keywords = item.getAttribute('data-search');
                    if (text.includes(searchTerm) || (keywords && keywords.includes(searchTerm))) {
                        results.push({
                            text: item.textContent.trim(),
                            page: item.getAttribute('data-page'),
                            icon: item.querySelector('i').className
                        });
                    }
                });

                // Search in evaluations
                appState.evaluations.forEach(eval => {
                    if (eval.student.toLowerCase().includes(searchTerm) ||
                        eval.content.toLowerCase().includes(searchTerm)) {
                        results.push({
                            text: `Evaluation: ${eval.student}`,
                            page: 'evaluations',
                            icon: 'fas fa-star'
                        });
                    }
                });

                // Search in materials
                appState.materials.forEach(material => {
                    if (material.title.toLowerCase().includes(searchTerm) ||
                        material.description.toLowerCase().includes(searchTerm)) {
                        results.push({
                            text: `Material: ${material.title}`,
                            page: 'materials',
                            icon: 'fas fa-book-open'
                        });
                    }
                });

                // Search in feedback
                appState.specificFeedback.forEach(feedback => {
                    if (feedback.student.toLowerCase().includes(searchTerm) ||
                        feedback.content.toLowerCase().includes(searchTerm)) {
                        results.push({
                            text: `Feedback: ${feedback.student} - ${feedback.type}`,
                            page: 'feedback',
                            icon: 'fas fa-comments'
                        });
                    }
                });

                // Search in topics
                appState.topics.forEach(topic => {
                    if (topic.title.toLowerCase().includes(searchTerm) ||
                        topic.description.toLowerCase().includes(searchTerm)) {
                        results.push({
                            text: `Topic: ${topic.title}`,
                            page: 'topics',
                            icon: 'fas fa-lightbulb'
                        });
                    }
                });

                // Search in sessions
                appState.sessionFeedback.forEach(session => {
                    if (session.student.toLowerCase().includes(searchTerm) ||
                        session.date.toLowerCase().includes(searchTerm)) {
                        results.push({
                            text: `Session: ${session.student} (${session.date})`,
                            page: 'sessions',
                            icon: 'fas fa-calendar-check'
                        });
                    }
                });

                // Render suggestions
                if (results.length > 0) {
                    suggestions.innerHTML = results.slice(0, 8).map(result => `
                        <div class="suggestion-item" data-page="${result.page}">
                            <i class="${result.icon}"></i>
                            <span>${result.text}</span>
                        </div>
                    `).join('');
                    suggestions.classList.add('show');
                } else {
                    suggestions.innerHTML = '<div class="suggestion-item">No results found</div>';
                    suggestions.classList.add('show');
                }
            });

            // Click on suggestion
            suggestions.addEventListener('click', function(e) {
                if (e.target.closest('.suggestion-item')) {
                    const page = e.target.closest('.suggestion-item').dataset.page;
                    switchPage(page); // Gá»i hÃ m chuyá»ƒn trang
                    suggestions.classList.remove('show');
                    document.getElementById('globalSearch').value = '';
                }
            });

            // Close suggestions when clicking outside
            document.addEventListener('click', function(e) {
                if (!searchInput.contains(e.target) && !suggestions.contains(e.target)) {
                    suggestions.classList.remove('show');
                }
            });
        }

        // ===== AVATAR HANDLING =====
        function setupAvatarHandling() {
            const avatar = document.getElementById('mainAvatar');
            const menu = document.getElementById('avatarMenu');

            // Toggle menu on avatar click
            avatar.addEventListener('click', function(e) {
                e.stopPropagation();
                menu.classList.toggle('show');
            });

            // Close menu when clicking outside
            document.addEventListener('click', function(e) {
                if (!menu.contains(e.target) && !avatar.contains(e.target)) {
                    menu.classList.remove('show');
                }
            });

            // Select avatar image
            document.querySelectorAll('.avatar-list img').forEach(img => {
                img.addEventListener('click', function(e) {
                    e.stopPropagation();
                    // Remove selected class from all avatars
                    document.querySelectorAll('.avatar-list img').forEach(i => i.classList.remove('selected'));
                    // Add selected class to clicked avatar
                    this.classList.add('selected');
                    // Update the main avatar source
                    avatar.src = this.src;
                    // Close the menu
                    menu.classList.remove('show');
                    showToast('âœ… Avatar updated!', 'success');
                });
            });

            // Handle image upload
            document.getElementById('imageUpload').addEventListener('change', function(e) {
                if (e.target.files && e.target.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        avatar.src = event.target.result;
                        // Also remove selected from other avatars if uploaded
                        document.querySelectorAll('.avatar-list img').forEach(i => i.classList.remove('selected'));
                        showToast('âœ… Avatar uploaded!', 'success');
                    }
                    reader.readAsDataURL(e.target.files[0]);
                }
            });
        }

        // ===== MODAL & UTILITY FUNCTIONS =====
        function openAddEvaluation() {
            const modalHtml = `
                <div id="addEvaluationModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; display: flex; align-items: center; justify-content: center;">
                    <div style="background: white; padding: 30px; border-radius: 20px; width: 500px; max-width: 90%; box-shadow: 0 10px 25px rgba(0,0,0,0.2);">
                        <h3 style="margin-bottom: 20px; color: #1a202c;">Add New Evaluation</h3>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Student Name</label>
                                <input type="text" id="evalStudent" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Level</label>
                                <select id="evalLevel" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;">
                                    <option value="Beginner (A1-A2)">Beginner (A1-A2)</option>
                                    <option value="Intermediate (B1-B2)">Intermediate (B1-B2)</option>
                                    <option value="Advanced (C1-C2)">Advanced (C1-C2)</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Evaluation Content</label>
                                <textarea id="evalContent" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 100px;" required></textarea>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Rating (1-5 stars)</label>
                                <div class="stars" id="evalStars">
                                    <span class="star" onclick="selectStar(1)">â˜…</span>
                                    <span class="star" onclick="selectStar(2)">â˜…</span>
                                    <span class="star" onclick="selectStar(3)">â˜…</span>
                                    <span class="star" onclick="selectStar(4)">â˜…</span>
                                    <span class="star" onclick="selectStar(5)">â˜…</span>
                                </div>
                                <input type="hidden" id="evalRating" value="5">
                            </div>
                            <div style="display: flex; gap: 10px; margin-top: 20px;">
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #6b7280; color: white; cursor: pointer;" onclick="closeModal('addEvaluationModal')">Cancel</button>
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #4361ee; color: white; cursor: pointer;" onclick="saveNewEvaluation()">Save</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        function openAddMaterial() {
            const modalHtml = `
                <div id="addMaterialModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; display: flex; align-items: center; justify-content: center;">
                    <div style="background: white; padding: 30px; border-radius: 20px; width: 500px; max-width: 90%; box-shadow: 0 10px 25px rgba(0,0,0,0.2);">
                        <h3 style="margin-bottom: 20px; color: #1a202c;">Add New Material</h3>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Material Title</label>
                                <input type="text" id="materialTitle" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Description</label>
                                <textarea id="materialDesc" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 80px;" required></textarea>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Material Type</label>
                                <select id="materialType" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;">
                                    <option value="PDF">PDF</option>
                                    <option value="Video">Video</option>
                                    <option value="Audio">Audio</option>
                                    <option value="Document">Document</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Target Level</label>
                                <select id="materialLevel" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;">
                                    <option value="Beginner">Beginner</option>
                                    <option value="Intermediate">Intermediate</option>
                                    <option value="Advanced">Advanced</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Material URL</label>
                                <input type="url" id="materialUrl" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Link Text</label>
                                <input type="text" id="materialLinkText" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;" value="View Material" required>
                            </div>
                            <div style="display: flex; gap: 10px; margin-top: 20px;">
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #6b7280; color: white; cursor: pointer;" onclick="closeModal('addMaterialModal')">Cancel</button>
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #4361ee; color: white; cursor: pointer;" onclick="saveNewMaterial()">Save</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        function openAddSpecificFeedback() {
            const modalHtml = `
                <div id="addSpecificFeedbackModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; display: flex; align-items: center; justify-content: center;">
                    <div style="background: white; padding: 30px; border-radius: 20px; width: 500px; max-width: 90%; box-shadow: 0 10px 25px rgba(0,0,0,0.2);">
                        <h3 style="margin-bottom: 20px; color: #1a202c;">Add New Feedback</h3>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Student Name</label>
                                <input type="text" id="feedbackStudent" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Feedback Type</label>
                                <select id="feedbackType" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;">
                                    <option value="pronunciation">Pronunciation</option>
                                    <option value="grammar">Grammar</option>
                                    <option value="vocabulary">Vocabulary</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Student Level</label>
                                <select id="feedbackLevel" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;">
                                    <option value="Beginner">Beginner</option>
                                    <option value="Intermediate">Intermediate</option>
                                    <option value="Advanced">Advanced</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Feedback Content</label>
                                <textarea id="feedbackContent" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 100px;" required></textarea>
                            </div>
                            <div style="display: flex; gap: 10px; margin-top: 20px;">
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #6b7280; color: white; cursor: pointer;" onclick="closeModal('addSpecificFeedbackModal')">Cancel</button>
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #4361ee; color: white; cursor: pointer;" onclick="saveNewSpecificFeedback()">Save</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        function openAddTopic() {
            const modalHtml = `
                <div id="addTopicModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; display: flex; align-items: center; justify-content: center;">
                    <div style="background: white; padding: 30px; border-radius: 20px; width: 500px; max-width: 90%; box-shadow: 0 10px 25px rgba(0,0,0,0.2);">
                        <h3 style="margin-bottom: 20px; color: #1a202c;">Add New Topic</h3>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Topic Title</label>
                                <input type="text" id="topicTitle" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Description</label>
                                <textarea id="topicDescription" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 100px;" required></textarea>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Target Level</label>
                                <select id="topicLevel" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;">
                                    <option value="Beginner">Beginner</option>
                                    <option value="Intermediate">Intermediate</option>
                                    <option value="Advanced">Advanced</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Proposed By</label>
                                <input type="text" id="topicAuthor" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;" value="Mentor A" required>
                            </div>
                            <div style="display: flex; gap: 10px; margin-top: 20px;">
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #6b7280; color: white; cursor: pointer;" onclick="closeModal('addTopicModal')">Cancel</button>
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #4361ee; color: white; cursor: pointer;" onclick="saveNewTopic()">Save</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        function openAddSessionFeedback() {
            const modalHtml = `
                <div id="addSessionModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; display: flex; align-items: center; justify-content: center;">
                    <div style="background: white; padding: 30px; border-radius: 20px; width: 600px; max-width: 90%; box-shadow: 0 10px 25px rgba(0,0,0,0.2);">
                        <h3 style="margin-bottom: 20px; color: #1a202c;">Add Session Feedback</h3>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Student Name</label>
                                <input type="text" id="sessionStudent" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Student Level</label>
                                <select id="sessionLevel" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;">
                                    <option value="Beginner">Beginner</option>
                                    <option value="Intermediate">Intermediate</option>
                                    <option value="Advanced">Advanced</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Session Date & Time</label>
                                <input type="datetime-local" id="sessionDate" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;" required>
                            </div>
                            <div style="margin-top: 20px;">
                                <h4 style="color: #4361ee; margin-bottom: 15px;">Pronunciation</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                    <div>
                                        <label>Strengths</label>
                                        <textarea id="pronunciationStrength" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 80px;"></textarea>
                                    </div>
                                    <div>
                                        <label>Areas for Improvement</label>
                                        <textarea id="pronunciationWeakness" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 80px;"></textarea>
                                    </div>
                                </div>
                                <div style="margin-top: 10px;">
                                    <label>Additional Notes</label>
                                    <textarea id="pronunciationNotes" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 60px;"></textarea>
                                </div>
                            </div>
                            <div style="margin-top: 20px;">
                                <h4 style="color: #4361ee; margin-bottom: 15px;">Vocabulary</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                    <div>
                                        <label>Strengths</label>
                                        <textarea id="vocabularyStrength" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 80px;"></textarea>
                                    </div>
                                    <div>
                                        <label>Areas for Improvement</label>
                                        <textarea id="vocabularyWeakness" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 80px;"></textarea>
                                    </div>
                                </div>
                                <div style="margin-top: 10px;">
                                    <label>Additional Notes</label>
                                    <textarea id="vocabularyNotes" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 60px;"></textarea>
                                </div>
                            </div>
                             <div style="margin-top: 20px;">
                                <h4 style="color: #4361ee; margin-bottom: 15px;">Grammar</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                    <div>
                                        <label>Strengths</label>
                                        <textarea id="grammarStrength" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 80px;"></textarea>
                                    </div>
                                    <div>
                                        <label>Areas for Improvement</label>
                                        <textarea id="grammarWeakness" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 80px;"></textarea>
                                    </div>
                                </div>
                                <div style="margin-top: 10px;">
                                    <label>Additional Notes</label>
                                    <textarea id="grammarNotes" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 60px;"></textarea>
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px; margin-top: 20px;">
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #6b7280; color: white; cursor: pointer;" onclick="closeModal('addSessionModal')">Cancel</button>
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #4361ee; color: white; cursor: pointer;" onclick="saveNewSession()">Save</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        function saveNewEvaluation() {
            const student = document.getElementById('evalStudent').value;
            const level = document.getElementById('evalLevel').value;
            const content = document.getElementById('evalContent').value;
            const rating = parseInt(document.getElementById('evalRating').value);

            if (!student || !content) {
                showToast('âš ï¸ Please fill in all required fields', 'error');
                return;
            }

            appState.addEvaluation({
                student: student,
                level: level,
                content: content,
                rating: rating,
                avatar: `https://i.pravatar.cc/40?u=${Math.random()}`
            });
            closeModal('addEvaluationModal');
        }

        function saveNewMaterial() {
            const title = document.getElementById('materialTitle').value;
            const desc = document.getElementById('materialDesc').value;
            const type = document.getElementById('materialType').value;
            const level = document.getElementById('materialLevel').value;
            const url = document.getElementById('materialUrl').value;
            const linkText = document.getElementById('materialLinkText').value;

            if (!title || !desc || !type || !level || !url) {
                showToast('âš ï¸ Please fill in all required fields', 'error');
                return;
            }

            const iconMap = {
                PDF: 'fa-file-pdf',
                Video: 'fa-video',
                Audio: 'fa-file-audio',
                Document: 'fa-file-word'
            };

            appState.addMaterial({
                title: title,
                description: desc,
                type: type,
                level: level,
                url: url,
                linkText: linkText,
                icon: iconMap[type] || 'fa-file'
            });
            closeModal('addMaterialModal');
        }

        function saveNewSpecificFeedback() {
            const student = document.getElementById('feedbackStudent').value;
            const type = document.getElementById('feedbackType').value;
            const level = document.getElementById('feedbackLevel').value;
            const content = document.getElementById('feedbackContent').value;

            if (!student || !content) {
                showToast('âš ï¸ Please enter student name and feedback content', 'error');
                return;
            }

            appState.addSpecificFeedback({
                student: student,
                type: type,
                level: level,
                content: content,
                avatar: `https://i.pravatar.cc/40?u=${Math.random()}`,
                date: new Date().toLocaleDateString('en-US')
            });
            closeModal('addSpecificFeedbackModal');
        }

        function saveNewTopic() {
            const title = document.getElementById('topicTitle').value;
            const desc = document.getElementById('topicDescription').value;
            const level = document.getElementById('topicLevel').value;
            const author = document.getElementById('topicAuthor').value;

            if (!title || !desc) {
                showToast('âš ï¸ Please enter topic title and description', 'error');
                return;
            }

            appState.addTopic({
                title: title,
                description: desc,
                level: level,
                author: author
            });
            closeModal('addTopicModal');
        }

        function saveNewSession() {
            const student = document.getElementById('sessionStudent').value;
            const level = document.getElementById('sessionLevel').value;
            const date = document.getElementById('sessionDate').value;
            const pronStrength = document.getElementById('pronunciationStrength').value;
            const pronWeakness = document.getElementById('pronunciationWeakness').value;
            const pronNotes = document.getElementById('pronunciationNotes').value;
            const vocabStrength = document.getElementById('vocabularyStrength').value;
            const vocabWeakness = document.getElementById('vocabularyWeakness').value;
            const vocabNotes = document.getElementById('vocabularyNotes').value;
             const grammarStrength = document.getElementById('grammarStrength').value;
            const grammarWeakness = document.getElementById('grammarWeakness').value;
            const grammarNotes = document.getElementById('grammarNotes').value;

            if (!student || !date) {
                showToast('âš ï¸ Please enter student name and session date', 'error');
                return;
            }

            appState.addSessionFeedback({
                student: student,
                level: level,
                date: new Date(date).toLocaleString('en-US'),
                pronunciationStrength: pronStrength,
                pronunciationWeakness: pronWeakness,
                pronunciationNotes: pronNotes,
                vocabularyStrength: vocabStrength,
                vocabularyWeakness: vocabWeakness,
                vocabularyNotes: vocabNotes,
                 grammarStrength: grammarStrength,
                grammarWeakness: grammarWeakness,
                grammarNotes: grammarNotes
            });
            closeModal('addSessionModal');
        }

        function editFeedback(id) {
            const feedback = appState.evaluations.find(f => f.id === id);
            if (!feedback) return;

            const modalHtml = `
                <div id="editEvaluationModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; display: flex; align-items: center; justify-content: center;">
                    <div style="background: white; padding: 30px; border-radius: 20px; width: 500px; max-width: 90%; box-shadow: 0 10px 25px rgba(0,0,0,0.2);">
                        <h3 style="margin-bottom: 20px; color: #1a202c;">Edit Evaluation</h3>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Student Name</label>
                                <input type="text" id="editEvalStudent" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;" value="${feedback.student}" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Level</label>
                                <select id="editEvalLevel" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;">
                                    <option value="Beginner (A1-A2)" ${feedback.level.includes('Beginner') ? 'selected' : ''}>Beginner (A1-A2)</option>
                                    <option value="Intermediate (B1-B2)" ${feedback.level.includes('Intermediate') ? 'selected' : ''}>Intermediate (B1-B2)</option>
                                    <option value="Advanced (C1-C2)" ${feedback.level.includes('Advanced') ? 'selected' : ''}>Advanced (C1-C2)</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Evaluation Content</label>
                                <textarea id="editEvalContent" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 100px;" required>${feedback.content}</textarea>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Rating (1-5 stars)</label>
                                <div class="stars" id="editEvalStars">
                                    ${[1,2,3,4,5].map(i => `
                                        <span class="star ${i <= feedback.rating ? 'active' : ''}" onclick="selectEditStar(${i})">â˜…</span>
                                    `).join('')}
                                </div>
                                <input type="hidden" id="editEvalRating" value="${feedback.rating}">
                            </div>
                            <div style="display: flex; gap: 10px; margin-top: 20px;">
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #6b7280; color: white; cursor: pointer;" onclick="closeModal('editEvaluationModal')">Cancel</button>
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #4361ee; color: white; cursor: pointer;" onclick="saveEditedFeedback('${id}')">Save Changes</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        function selectEditStar(rating) {
            document.querySelectorAll('#editEvalStars .star').forEach((star, index) => {
                star.classList.toggle('active', index < rating);
            });
            document.getElementById('editEvalRating').value = rating;
        }

        function saveEditedFeedback(id) {
            const student = document.getElementById('editEvalStudent').value;
            const level = document.getElementById('editEvalLevel').value;
            const content = document.getElementById('editEvalContent').value;
            const rating = parseInt(document.getElementById('editEvalRating').value);

            appState.updateEvaluation(id, {
                student: student,
                level: level,
                content: content,
                rating: rating
            });
            closeModal('editEvaluationModal');
        }

        function deleteFeedback(id) {
            if (confirm('Are you sure you want to delete this evaluation?')) {
                appState.deleteEvaluation(id);
            }
        }

        function editSpecificFeedback(id, type) {
            const feedback = appState.specificFeedback.find(f => f.id === id);
            if (!feedback) return;

            const modalHtml = `
                <div id="editSpecificFeedbackModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; display: flex; align-items: center; justify-content: center;">
                    <div style="background: white; padding: 30px; border-radius: 20px; width: 500px; max-width: 90%; box-shadow: 0 10px 25px rgba(0,0,0,0.2);">
                        <h3 style="margin-bottom: 20px; color: #1a202c;">Edit Feedback</h3>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Student Name</label>
                                <input type="text" id="editFeedbackStudent" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;" value="${feedback.student}" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Feedback Type</label>
                                <select id="editFeedbackType" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;">
                                    <option value="pronunciation" ${type === 'pronunciation' ? 'selected' : ''}>Pronunciation</option>
                                    <option value="grammar" ${type === 'grammar' ? 'selected' : ''}>Grammar</option>
                                    <option value="vocabulary" ${type === 'vocabulary' ? 'selected' : ''}>Vocabulary</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Student Level</label>
                                <select id="editFeedbackLevel" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;">
                                    <option value="Beginner" ${feedback.level === 'Beginner' ? 'selected' : ''}>Beginner</option>
                                    <option value="Intermediate" ${feedback.level === 'Intermediate' ? 'selected' : ''}>Intermediate</option>
                                    <option value="Advanced" ${feedback.level === 'Advanced' ? 'selected' : ''}>Advanced</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Feedback Content</label>
                                <textarea id="editFeedbackContent" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 100px;" required>${feedback.content}</textarea>
                            </div>
                            <div style="display: flex; gap: 10px; margin-top: 20px;">
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #6b7280; color: white; cursor: pointer;" onclick="closeModal('editSpecificFeedbackModal')">Cancel</button>
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #4361ee; color: white; cursor: pointer;" onclick="saveEditedSpecificFeedback('${id}')">Save Changes</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        function saveEditedSpecificFeedback(id) {
            const student = document.getElementById('editFeedbackStudent').value;
            const type = document.getElementById('editFeedbackType').value;
            const level = document.getElementById('editFeedbackLevel').value;
            const content = document.getElementById('editFeedbackContent').value;

            appState.updateSpecificFeedback(id, {
                student: student,
                type: type,
                level: level,
                content: content
            });
            closeModal('editSpecificFeedbackModal');
        }

        function deleteSpecificFeedback(id) {
            if (confirm('Are you sure you want to delete this feedback?')) {
                appState.deleteSpecificFeedback(id);
            }
        }

        function editTopic(id) {
            const topic = appState.topics.find(t => t.id === id);
            if (!topic) return;

            const modalHtml = `
                <div id="editTopicModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; display: flex; align-items: center; justify-content: center;">
                    <div style="background: white; padding: 30px; border-radius: 20px; width: 500px; max-width: 90%; box-shadow: 0 10px 25px rgba(0,0,0,0.2);">
                        <h3 style="margin-bottom: 20px; color: #1a202c;">Edit Topic</h3>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Topic Title</label>
                                <input type="text" id="editTopicTitle" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;" value="${topic.title}" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Description</label>
                                <textarea id="editTopicDescription" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px; min-height: 100px;" required>${topic.description}</textarea>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 500;">Target Level</label>
                                <select id="editTopicLevel" style="width: 100%; padding: 10px; border: 1px solid #d6e4ff; border-radius: 8px;">
                                    <option value="Beginner" ${topic.level === 'Beginner' ? 'selected' : ''}>Beginner</option>
                                    <option value="Intermediate" ${topic.level === 'Intermediate' ? 'selected' : ''}>Intermediate</option>
                                    <option value="Advanced" ${topic.level === 'Advanced' ? 'selected' : ''}>Advanced</option>
                                </select>
                            </div>
                            <div style="display: flex; gap: 10px; margin-top: 20px;">
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #6b7280; color: white; cursor: pointer;" onclick="closeModal('editTopicModal')">Cancel</button>
                                <button style="flex: 1; padding: 10px; border: none; border-radius: 8px; background: #4361ee; color: white; cursor: pointer;" onclick="saveEditedTopic('${id}')">Save Changes</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        function saveEditedTopic(id) {
            const title = document.getElementById('editTopicTitle').value;
            const desc = document.getElementById('editTopicDescription').value;
            const level = document.getElementById('editTopicLevel').value;

            appState.updateTopic(id, {
                title: title,
                description: desc,
                level: level
            });
            closeModal('editTopicModal');
        }

        function deleteTopic(id) {
            if (confirm('Are you sure you want to delete this topic?')) {
                appState.deleteTopic(id);
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.remove();
            }
        }

        function selectStar(rating) {
            document.querySelectorAll('#evalStars .star').forEach((star, index) => {
                star.classList.toggle('active', index < rating);
            });
            document.getElementById('evalRating').value = rating;
        }

        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast show ${type}`;
            setTimeout(() => {
                toast.className = 'toast';
            }, 3000);
        }

        function saveSessionFeedback(sessionId, fieldType) {
            const textarea = document.querySelector(`.session-input[data-session="${sessionId}"][data-type="${fieldType}"]`);
            const newValue = textarea.value;

            const fieldMap = {
                'pronunciation': `pronunciation${fieldType.charAt(0).toUpperCase() + fieldType.slice(1)}`,
                'vocabulary': `vocabulary${fieldType.charAt(0).toUpperCase() + fieldType.slice(1)}`,
                'grammar': `grammar${fieldType.charAt(0).toUpperCase() + fieldType.slice(1)}`
            };

            appState.updateSessionFeedback(sessionId, fieldMap[fieldType] || fieldType, newValue);
        }

        function cancelSessionEdit(sessionId) {
            const session = appState.sessionFeedback.find(s => s.id === sessionId);
            if (!session) return;

            document.querySelectorAll(`.session-input[data-session="${sessionId}"]`).forEach(textarea => {
                const type = textarea.dataset.type;
                const fieldKey = `${type}${type.charAt(0).toUpperCase() + type.slice(1)}`;
                textarea.value = session[fieldKey] || '';
            });
        }

        function rateFeedback(id, rating) {
            const stars = document.querySelectorAll(`#stars${id} .star`);
            stars.forEach((star, index) => {
                star.classList.toggle('active', index < rating);
            });

            const evalIndex = appState.evaluations.findIndex(e => e.id === id);
            if (evalIndex !== -1) {
                appState.evaluations[evalIndex].rating = rating;
                localStorage.setItem('mentor_evaluations', JSON.stringify(appState.evaluations));
                showToast(`âœ… Updated rating to ${rating} stars`, 'success');
            }
        }

        function filterEvaluations(searchTerm) {
            const cards = document.querySelectorAll('#evaluationsList .feedback-card');
            cards.forEach(card => {
                const studentName = card.querySelector('.feedback-author strong').textContent.toLowerCase();
                const content = card.querySelector('.feedback-content p').textContent.toLowerCase();
                if (studentName.includes(searchTerm.toLowerCase()) || content.includes(searchTerm.toLowerCase())) {
                    card.style.display = '';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function filterByLevel(level) {
            const cards = document.querySelectorAll('#evaluationsList .feedback-card');
            cards.forEach(card => {
                const studentLevel = card.querySelector('.feedback-author div').textContent.toLowerCase();
                if (level === '' || studentLevel.includes(level.toLowerCase())) {
                    card.style.display = '';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function searchMaterials(searchTerm) {
            const cards = document.querySelectorAll('.material-card');
            cards.forEach(card => {
                const title = card.querySelector('.material-title').textContent.toLowerCase();
                const desc = card.querySelector('.material-desc').textContent.toLowerCase();
                if (title.includes(searchTerm.toLowerCase()) || desc.includes(searchTerm.toLowerCase())) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function filterFeedbackByType(type) {
            const cards = document.querySelectorAll('#specificFeedbackList .feedback-card');
            cards.forEach(card => {
                const feedbackType = card.querySelector('.feedback-author div').textContent.split('-')[0].trim().toLowerCase();
                if (type === '' || feedbackType.includes(type)) {
                    card.style.display = '';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function filterFeedbackByStudent(searchTerm) {
            const cards = document.querySelectorAll('#specificFeedbackList .feedback-card');
            cards.forEach(card => {
                const studentName = card.querySelector('.feedback-author strong').textContent.toLowerCase();
                if (studentName.includes(searchTerm.toLowerCase())) {
                    card.style.display = '';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function searchTopics(searchTerm) {
            const cards = document.querySelectorAll('.topic-card');
            cards.forEach(card => {
                const title = card.querySelector('h4').textContent.toLowerCase();
                const desc = card.querySelector('p').textContent.toLowerCase();
                if (title.includes(searchTerm.toLowerCase()) || desc.includes(searchTerm.toLowerCase())) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function filterSessions(searchTerm) {
            const cards = document.querySelectorAll('#sessionsList .session-card');
            cards.forEach(card => {
                const studentName = card.querySelector('.session-student').textContent.toLowerCase();
                if (studentName.includes(searchTerm.toLowerCase())) {
                    card.style.display = '';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // ===== INITIALIZE APP =====
        document.addEventListener('DOMContentLoaded', () => {
            appState.init();

            // Gáº¯n sá»± kiá»‡n click cho sidebar sau khi DOM Ä‘Ã£ load xong
            document.querySelectorAll('.sidebar li').forEach(item => {
                item.addEventListener('click', function() {
                    const pageId = this.getAttribute('data-page');
                    switchPage(pageId); // <<<=== Gá»ŒI HÃ€M SWITCHPAGE ===>>>
                    showToast(`ðŸ“„ Switched to: ${this.textContent.trim()}`, 'info');
                });
            });

            // Initialize demo data only if not already initialized
            if (!localStorage.getItem('mentor_demo_initialized')) {
                const demoData = {
                    evaluations: [
                        {
                            id: '1',
                            student: 'Emma Johnson',
                            level: 'Intermediate (B1)',
                            content: 'Emma shows great improvement in pronunciation. She needs more practice with complex grammar structures.',
                            rating: 5,
                            avatar: 'https://i.pravatar.cc/40?img=10',
                            date: '05/02/2025 7:45 PM',
                            mentor: 'John Smith'
                        },
                        {
                            id: '2',
                            student: 'Adam Brown',
                            level: 'Beginner (A2)',
                            content: 'Adam needs to improve listening comprehension and vocabulary range. Encourage more speaking practice.',
                            rating: 2,
                            avatar: 'https://i.pravatar.cc/40?img=11',
                            date: '05/02/2025 6:23 PM',
                            mentor: 'Sarah Kim'
                        }
                    ],
                    materials: [
                        {
                            id: '1',
                            title: 'Business English Vocabulary',
                            description: 'Comprehensive list of 500 business-related English terms with definitions and examples.',
                            type: 'PDF',
                            level: 'Intermediate',
                            url: 'https://example.com/business-vocab.pdf',
                            linkText: 'Download PDF',
                            icon: 'fa-file-pdf'
                        },
                        {
                            id: '2',
                            title: 'Pronunciation Guide: Th Sounds',
                            description: 'Video tutorial demonstrating how to pronounce /Î¸/ and /Ã°/ sounds with practice exercises.',
                            type: 'Video',
                            level: 'Beginner',
                            url: 'https://example.com/pronunciation-th.mp4',
                            linkText: 'Watch Video',
                            icon: 'fa-video'
                        },
                        {
                            id: '3',
                            title: 'Grammar Exercise: Present Perfect',
                            description: '50 practice questions on present perfect tense with detailed explanations and answers.',
                            type: 'Document',
                            level: 'Intermediate',
                            url: 'https://example.com/present-perfect.docx',
                            linkText: 'Download',
                            icon: 'fa-file-word'
                        }
                    ],
                    specificFeedback: [
                        {
                            id: '1',
                            student: 'Emma Johnson',
                            type: 'Pronunciation',
                            level: 'Beginner',
                            content: 'Emma needs to practice the /Î¸/ sound in words like "think" and "thank". Current pronunciation sounds like /s/.',
                            avatar: 'https://i.pravatar.cc/40?img=10',
                            date: '05/02/2025'
                        },
                        {
                            id: '2',
                            student: 'Adam Brown',
                            type: 'Grammar',
                            level: 'Intermediate',
                            content: 'Adam often confuses past simple with present perfect. Recommend reviewing rule differences.',
                            avatar: 'https://i.pravatar.cc/40?img=11',
                            date: '05/02/2025'
                        }
                    ],
                    topics: [
                        {
                            id: '1',
                            title: 'Job Interview Practice',
                            description: 'Common interview questions and how to answer them confidently',
                            level: 'Intermediate',
                            author: 'Mentor A'
                        },
                        {
                            id: '2',
                            title: 'Hotel Booking Conversation',
                            description: 'Sample dialogues for booking a hotel room over the phone',
                            level: 'Beginner',
                            author: 'Mentor B'
                        },
                        {
                            id: '3',
                            title: 'Team Meeting Discussions',
                            description: 'How to present ideas and give feedback in team meetings',
                            level: 'Advanced',
                            author: 'Mentor C'
                        }
                    ],
                    sessionFeedback: [
                        {
                            id: '1',
                            student: 'Emma Johnson',
                            level: 'Intermediate',
                            date: '05/02/2025 7:00 PM - 7:30 PM',
                            pronunciationStrength: 'Good intonation and rhythm',
                            pronunciationWeakness: 'Final consonants need more practice',
                            pronunciationNotes: 'Emma pronounced most words clearly but needs to practice final consonants like \'d\', \'t\', and \'s\' endings.',
                            vocabularyStrength: 'Uses varied vocabulary',
                            vocabularyWeakness: 'Some context errors',
                            vocabularyNotes: 'Emma has good vocabulary range but occasionally uses words in incorrect contexts. Suggest more practice with collocations.'
                        },
                        {
                            id: '2',
                            student: 'Adam Brown',
                            level: 'Beginner',
                            date: '05/02/2025 6:00 PM - 6:30 PM',
                            grammarStrength: 'Understands basic structures',
                            grammarWeakness: 'Past tense usage',
                            grammarNotes: 'Adam struggles with past tense formation. Recommend more exercises focusing on irregular verbs.',
                            listeningStrength: 'Follows simple instructions',
                            listeningWeakness: 'Complex sentences',
                            listeningNotes: 'Adam needs more practice with complex sentence structures. Recommend slower-paced audio materials.'
                        }
                    ]
                };
                localStorage.setItem('mentor_evaluations', JSON.stringify(demoData.evaluations));
                localStorage.setItem('mentor_materials', JSON.stringify(demoData.materials));
                localStorage.setItem('mentor_specific_feedback', JSON.stringify(demoData.specificFeedback));
                localStorage.setItem('mentor_topics', JSON.stringify(demoData.topics));
                localStorage.setItem('mentor_session_feedback', JSON.stringify(demoData.sessionFeedback));
                localStorage.setItem('mentor_demo_initialized', 'true');
                console.log('Demo data initialized');
            }
        });
    </script>
</body>
</html>
